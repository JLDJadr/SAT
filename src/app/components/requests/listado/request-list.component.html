<section ngClass="header">
    <h1>Seguiment incidències / sol·licituds informàtiques</h1>
    <section ngClass="button-area">
        <button mat-raised-button color="primary" [routerLink]="['/request/form']">Registro</button>
        <button mat-raised-button color="primary" [routerLink]="['/request/list']">Seguimiento</button>
    </section>
</section>
<section ngClass="filter-area">
    <mat-form-field>
        <mat-label>Filtrar per text</mat-label>
        <input matInput (keyup)="freeFilter($event)" placeholder="Ex. my free text" />
    </mat-form-field>
    <mat-form-field>
        <mat-label>Filtrar per tipus de sol·licitud</mat-label>
        <mat-select multiple (selectionChange)="selectFilter($event, 'type')">
            <mat-option value="Petició">Petició</mat-option>
            <mat-option value="Incidència">Incidència</mat-option>
        </mat-select>
    </mat-form-field>
    <mat-form-field>
        <mat-label>Filtrar per situació</mat-label>
        <mat-select multiple (selectionChange)="selectFilter($event, 'status')">
            <mat-option value="progress">{{'progress' | statusName}}</mat-option>
            <mat-option value="pending">{{'pending' | statusName}}</mat-option>
            <mat-option value="pendingUser">{{'pendingUser' | statusName}}</mat-option>
            <mat-option value="closed">{{'closed' | statusName}}</mat-option>
        </mat-select>
    </mat-form-field>
</section>

<section ngClass="mat-elevation-z8">
    <mat-progress-bar *ngIf="loading" mode="indeterminate"></mat-progress-bar>
    <mat-table *ngIf="dataSource" [dataSource]="dataSource" matSort>
        <ng-container [matColumnDef]="col.key" *ngFor="let col of columnsSchema">
            <mat-header-cell *matHeaderCellDef mat-sort-header [ngSwitch]="col.key">
                <span *ngSwitchDefault><strong>{{col.label}}</strong></span>
            </mat-header-cell>
            <mat-cell *matCellDef="let element">
                <section [ngSwitch]="col.type">
                    <a *ngSwitchCase="'url'" [routerLink]="['/request/list/', element.id]" title="Detalles"
                        ngClass="link-data">{{element[col.key]}}
                    </a>
                    <span *ngSwitchCase="'type'" ngClass="{{element[col.key]}}">{{element[col.key]}}</span>
                    <span *ngSwitchCase="'date'" ngClass="date">{{element[col.key]
                        | date : "dd-MM-YYYY HH:mm:ss"}}</span>
                    <span *ngSwitchCase="'description'" ngClass="description-data">{{element[col.key]}}</span>
                    <span *ngSwitchCase="'status'" ngClass="{{element[col.key]}}">{{element[col.key] |
                        statusName}}</span>
                    <span *ngSwitchDefault ngClass="data">{{element[col.key]}}</span>
                </section>
            </mat-cell>
        </ng-container>
        <mat-header-row *matHeaderRowDef="columnsDisplayed"></mat-header-row>
        <mat-row *matRowDef="let row; columns: columnsDisplayed;"></mat-row>
    </mat-table>
    <mat-paginator [pageSizeOptions]='[25, 30, 50, 100]' showFirstLastButtons></mat-paginator>
</section>